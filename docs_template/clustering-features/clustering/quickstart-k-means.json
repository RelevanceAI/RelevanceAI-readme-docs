{
  "metadata": {
    "image": [],
    "title": "",
    "description": ""
  },
  "api": {
    "method": "get",
    "url": "",
    "auth": "required",
    "results": {
      "codes": [
        {
          "name": "",
          "code": "{}",
          "language": "json",
          "status": 200
        },
        {
          "name": "",
          "code": "{}",
          "language": "json",
          "status": 400
        }
      ]
    },
    "params": []
  },
  "next": {
    "description": "",
    "pages": []
  },
  "title": "Quickstart (K Means)",
  "updates": [],
  "type": "basic",
  "slug": "quickstart-k-means",
  "excerpt": "",
  "body": "<figure>\n<img src=\"https://github.com/RelevanceAI/RelevanceAI-readme-docs/blob/v2.0.0/docs_template/clustering-features/_assets/RelevanceAI_clustering.png?raw=true\"  width=\"450\" alt=\"Clustering effect on pricing\" />\n<figcaption>Clustering showing how a certain variety of images can improve pricing</figcaption>\n<figure>\n\n## Introduction\n\nClustering groups items so that those in the same group/cluster have meaningful similarities (i.e. specific features or properties). Clustering facilitates informed decision-making by giving significant meaning to data through the identification of different patterns. Relying on strong vector representations, Relevance AI provides you with powerful and easy-to-use clustering endpoints.\n\nIn this guide, you will learn to run KMeans clustering via **only one line of code**. K-Means clustering partitions your dataset into K distinct clusters.\n\n[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/RelevanceAI/RelevanceAI-readme-docs/blob/v2.0.0/docs/clustering-features/clustering/_notebooks/RelevanceAI-ReadMe-Kmeans-Clustering.ipynb)\n\n### 1. Create a dataset and insert data\n\nFirst, you need to install Relevance AI's Python SDK and set up a client object to interact with RelevanceAI. For more information, please read the [installation](doc:installation) guide.\n\n[block:code]\n{\n  \"codes\": [\n    {\n      \"code\": \"# remove `!` if running the line in a terminal\\n!pip install -U RelevanceAI[notebook]==2.0.0\",\n      \"name\": \"Bash\",\n      \"language\": \"shell\"\n    }\n  ]\n}\n[/block]\n\n[block:code]\n{\n  \"codes\": [\n    {\n      \"code\": \"from relevanceai import Client\\n\\n\\\"\\\"\\\"\\nYou can sign up/login and find your credentials here: https://cloud.relevance.ai/sdk/api\\nOnce you have signed up, click on the value under `Activation token` and paste it here\\n\\\"\\\"\\\"\\nclient = Client()\",\n      \"name\": \"Python (SDK)\",\n      \"language\": \"python\"\n    }\n  ]\n}\n[/block]\n\nYou also need to have a dataset under your Relevance AI account. You can either use our sample sample data as shown in this step or follow the tutorial on [how to create your own dataset](doc:project-and-dataset).\n\nIn this guide, we use our e-commerce database, which includes fields such as `product_name`, as well as the vectorized version of the field `product_name_default_vector_`. Loading these documents can be done via:\n\n[block:code]\n{\n  \"codes\": [\n    {\n      \"code\": \"from relevanceai.datasets import get_ecommerce_dataset_encoded\\n\\ndocuments = get_ecommerce_dataset_encoded()\\n{k:v for k, v in documents[0].items() if '_vector_' not in k}\",\n      \"name\": \"Python (SDK)\",\n      \"language\": \"python\"\n    }\n  ]\n}\n[/block]\n\nNext, we can upload these documents into your personal Relevance AI account under the name *quickstart_clustering_kmeans*\n\n[block:code]\n{\n  \"codes\": [\n    {\n      \"code\": \"ds = client.Dataset(\\\"quickstart_kmeans_clustering\\\")\\nds.insert_documents(documents)\",\n      \"name\": \"Python (SDK)\",\n      \"language\": \"python\"\n    }\n  ]\n}\n[/block]\n\nLet's have a look at the schema to see what vector fields are available for clustering.\n\n[block:code]\n{\n  \"codes\": [\n    {\n      \"code\": \"ds.schema\",\n      \"name\": \"Python (SDK)\",\n      \"language\": \"python\"\n    }\n  ]\n}\n[/block]\n\nThe result is a JSON output similar to what is shown below. As can be seen, there are two vector fields in the dataset `product_image_clip_vector_` and `product_title_clip_vector_`.\n\n[block:code]\n{\n  \"codes\": [\n    {\n      \"code\": \"{\\n 'insert_date_': 'date',\\n 'product_image': 'text',\\n 'product_image_clip_vector_': {'vector': 512},\\n 'product_link': 'text',\\n 'product_price': 'text',\\n 'product_title': 'text',\\n 'product_title_clip_vector_': {'vector': 512},\\n 'query': 'text',\\n 'source': 'text'\\n}\",\n      \"name\": \"JSON\",\n      \"language\": \"json\"\n    }\n  ]\n}\n[/block]\n\n### 2. Run Kmeans clustering algorithm in one go\nThe easiest way to run a Kmeans clustering algorithm under the Relevance AI platform is the `auto_cluster` function. The following code snippet shows how generate 10 clusters using the `product_title_clip_vector_` vector field.\n\n[block:code]\n{\n  \"codes\": [\n    {\n      \"code\": \"clusterer = ds.auto_cluster(ALIAS-10, [\\\"product_title_clip_vector_\\\"])\",\n      \"name\": \"Python (SDK)\",\n      \"language\": \"python\"\n    }\n  ]\n}\n[/block]\n\nAnother way of clustering is to use the ClusterOps class as shown in the snippet below:\n\n[block:code]\n{\n  \"codes\": [\n    {\n      \"code\": \"from relevanceai.clusterer import KMeansModel\\n\\nVECTOR_FIELD = \\\"product_title_clip_vector_\\\"\\nKMEAN_NUMBER_OF_CLUSTERS = 10\\nALIAS = \\\"kmeans_\\\" + str(KMEAN_NUMBER_OF_CLUSTERS)\\n\\nmodel = KMeansModel(k=KMEAN_NUMBER_OF_CLUSTERS)\\nclusterer = client.ClusterOps(alias=ALIAS, model=model)\\nclusterer.fit_predict_update(df, [VECTOR_FIELD])\",\n      \"name\": \"Python (SDK)\",\n      \"language\": \"python\"\n    }\n  ]\n}\n[/block]\n\n\nThe `fit_predict_update()` function performs the following steps:\n1. loading the data\n2. clustering\n3. writing the results back to the dataset\n\nBy loading the data from the dataset after clustering is done, you can see to which cluster each data point belongs. Here, we see how the first 5 data points are clustered:\n\n[block:code]\n{\n  \"codes\": [\n    {\n      \"code\": \"from relevanceai import show_json\\n\\nsample_documents = ds.sample(n=5)\\nsamples = [{\\n    'product_title':d['product_title'],\\n    'cluster':d['_cluster_'][VECTOR_FIELD][ALIAS]\\n} for d in sample_documents]\\n\\nshow_json(samples, text_fields=['product_title', 'cluster'])\",\n      \"name\": \"Python (SDK)\",\n      \"language\": \"python\"\n    }\n  ]\n}\n[/block]\n\n<figure>\n<img src=\"https://github.com/RelevanceAI/RelevanceAI-readme-docs/blob/v2.0.0/docs_template/clustering-features/_assets/RelevanceAI_clustering_quickstart_kmeans_results.png?raw=true\"  width=\"450\" alt=\"Clustering results\" />\n<figcaption></figcaption>\n<figure>\n\nIf you are interested to know more details about what happens behind the scene, visit our next page on step-by-step clustering.",
  "order": 0,
  "isReference": false,
  "deprecated": false,
  "hidden": false,
  "sync_unique": "",
  "link_url": "",
  "link_external": false,
  "pendingAlgoliaPublish": false,
  "previousSlug": "",
  "slugUpdatedAt": "2021-12-09T21:24:56.603Z",
  "_id": "623a96a3032c43002ef2c69f",
  "createdAt": "2021-12-10T01:56:27.206Z",
  "updatedAt": "2022-03-31T06:19:17.502Z",
  "user": "61728a60ec09310078b1671d",
  "parentDoc": "623a96a3032c43002ef2c68d",
  "category": "623a96a3032c43002ef2c617",
  "project": "616e2c4a41d673001632944d",
  "version": "623a96a3032c43002ef2c73f",
  "__v": 0,
  "lastUpdatedHash": "e7c35bb591378717d2d44ff08398cbb660edabbc",
  "isApi": false,
  "id": "623a96a3032c43002ef2c69f",
  "body_html": "<div class=\"magic-block-textarea\"><p>&lt;figure&gt;<br><img src=\"https://github.com/RelevanceAI/RelevanceAI-readme-docs/blob/v2.0.0/docs_template/clustering-features/_assets/RelevanceAI_clustering.png?raw=true\"  width=\"450\" alt=\"Clustering effect on pricing\"></p>\n<p>&lt;figcaption&gt;Clustering showing how a certain variety of images can improve pricing&lt;/figcaption&gt;</p>\n<p>&lt;figure&gt;\n\n</p>\n<h2 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-introduction\"></div>Introduction<a class=\"fa fa-anchor\" href=\"#section-introduction\"></a></h2>\n<p>Clustering groups items so that those in the same group/cluster have meaningful similarities (i.e. specific features or properties). Clustering facilitates informed decision-making by giving significant meaning to data through the identification of different patterns. Relying on strong vector representations, Relevance AI provides you with powerful and easy-to-use clustering endpoints.</p>\n<p>In this guide, you will learn to run KMeans clustering via <strong>only one line of code</strong>. K-Means clustering partitions your dataset into K distinct clusters.</p>\n<p><a href=\"https://colab.research.google.com/github/RelevanceAI/RelevanceAI-readme-docs/blob/v2.0.0/docs/clustering-features/clustering/_notebooks/RelevanceAI-ReadMe-Kmeans-Clustering.ipynb\"><img src=\"https://colab.research.google.com/assets/colab-badge.svg\" alt=\"Open In Colab\"></a></p>\n<h3 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-1-create-a-dataset-and-insert-data\"></div>1. Create a dataset and insert data<a class=\"fa fa-anchor\" href=\"#section-1-create-a-dataset-and-insert-data\"></a></h3>\n<p>First, you need to install Relevance AI&#39;s Python SDK and set up a client object to interact with RelevanceAI. For more information, please read the <a href=\"https://docs.relevance.ai/docs/installation\" class=\"doc-link\" data-sidebar=\"installation\">installation</a> guide.</p>\n\n</div>\n<div class=\"magic-block-code\">\n\t<ul class=\"block-code-header\">\n\t\t<li><a href=\"\" ng-click=\"showCode(0)\" ng-class=\"{active: (0 == tab)}\">Bash</a></li>\n\t</ul>\n\t<div class=\"block-code-code\"><span ng-if=\"tab == 0\">\n\t\t\t<button ng-click=\"copyCode(850)\" class=\"copy-code-button\"><span ng-show=\"!copied\" class=\"fa fa-clipboard\"></span><span ng-show=\"copied\" class=\"fa fa-check\"></span></button>\n\t\t\t<textarea ng-non-bindable=\"ng-non-bindable\" style=\"position: absolute; left: -10000px;\" id=\"text-code-850\"># remove `!` if running the line in a terminal\n!pip install -U RelevanceAI[notebook]==2.0.0</textarea>\n\t\t\t<pre id=\"code-850\"><code><span class='cm-s-neo'><span class=\"cm-comment\"># remove `!` if running the line in a terminal</span>\n!pip install <span class=\"cm-attribute\">-U</span> RelevanceAI[notebook]<span class=\"cm-operator\">==</span><span class=\"cm-number\">2</span>.0.0</span></code></pre></span>\n\t</div>\n</div>\n<div class=\"magic-block-code\">\n\t<ul class=\"block-code-header\">\n\t\t<li><a href=\"\" ng-click=\"showCode(0)\" ng-class=\"{active: (0 == tab)}\">Python (SDK)</a></li>\n\t</ul>\n\t<div class=\"block-code-code\"><span ng-if=\"tab == 0\">\n\t\t\t<button ng-click=\"copyCode(373)\" class=\"copy-code-button\"><span ng-show=\"!copied\" class=\"fa fa-clipboard\"></span><span ng-show=\"copied\" class=\"fa fa-check\"></span></button>\n\t\t\t<textarea ng-non-bindable=\"ng-non-bindable\" style=\"position: absolute; left: -10000px;\" id=\"text-code-373\">from relevanceai import Client\n\n&quot;&quot;&quot;\nYou can sign up/login and find your credentials here: https://cloud.relevance.ai/sdk/api\nOnce you have signed up, click on the value under `Activation token` and paste it here\n&quot;&quot;&quot;\nclient = Client()</textarea>\n\t\t\t<pre id=\"code-373\"><code><span class='cm-s-neo'><span class=\"cm-keyword\">from</span> <span class=\"cm-variable\">relevanceai</span> <span class=\"cm-keyword\">import</span> <span class=\"cm-variable\">Client</span>\n\n<span class=\"cm-string\">\"\"\"</span>\n<span class=\"cm-string\">You can sign up&#47;login and find your credentials here: https:&#47;&#47;cloud.relevance.ai&#47;sdk&#47;api</span>\n<span class=\"cm-string\">Once you have signed up, click on the value under `Activation token` and paste it here</span>\n<span class=\"cm-string\">\"\"\"</span>\n<span class=\"cm-variable\">client</span> <span class=\"cm-operator\">=</span> <span class=\"cm-variable\">Client</span>()</span></code></pre></span>\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><p>You also need to have a dataset under your Relevance AI account. You can either use our sample sample data as shown in this step or follow the tutorial on <a href=\"https://docs.relevance.ai/docs/project-and-dataset\" class=\"doc-link\" data-sidebar=\"project-and-dataset\">how to create your own dataset</a>.</p>\n<p>In this guide, we use our e-commerce database, which includes fields such as <code>product_name</code>, as well as the vectorized version of the field <code>product_name_default_vector_</code>. Loading these documents can be done via:</p>\n\n</div>\n<div class=\"magic-block-code\">\n\t<ul class=\"block-code-header\">\n\t\t<li><a href=\"\" ng-click=\"showCode(0)\" ng-class=\"{active: (0 == tab)}\">Python (SDK)</a></li>\n\t</ul>\n\t<div class=\"block-code-code\"><span ng-if=\"tab == 0\">\n\t\t\t<button ng-click=\"copyCode(996)\" class=\"copy-code-button\"><span ng-show=\"!copied\" class=\"fa fa-clipboard\"></span><span ng-show=\"copied\" class=\"fa fa-check\"></span></button>\n\t\t\t<textarea ng-non-bindable=\"ng-non-bindable\" style=\"position: absolute; left: -10000px;\" id=\"text-code-996\">from relevanceai.datasets import get_ecommerce_dataset_encoded\n\ndocuments = get_ecommerce_dataset_encoded()\n{k:v for k, v in documents[0].items() if '_vector_' not in k}</textarea>\n\t\t\t<pre id=\"code-996\"><code><span class='cm-s-neo'><span class=\"cm-keyword\">from</span> <span class=\"cm-variable\">relevanceai</span>.<span class=\"cm-property\">datasets</span> <span class=\"cm-keyword\">import</span> <span class=\"cm-variable\">get_ecommerce_dataset_encoded</span>\n\n<span class=\"cm-variable\">documents</span> <span class=\"cm-operator\">=</span> <span class=\"cm-variable\">get_ecommerce_dataset_encoded</span>()\n{<span class=\"cm-variable\">k</span>:<span class=\"cm-variable\">v</span> <span class=\"cm-keyword\">for</span> <span class=\"cm-variable\">k</span>, <span class=\"cm-variable\">v</span> <span class=\"cm-keyword\">in</span> <span class=\"cm-variable\">documents</span>[<span class=\"cm-number\">0</span>].<span class=\"cm-property\">items</span>() <span class=\"cm-keyword\">if</span> <span class=\"cm-string\">'_vector_'</span> <span class=\"cm-keyword\">not</span> <span class=\"cm-keyword\">in</span> <span class=\"cm-variable\">k</span>}</span></code></pre></span>\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><p>Next, we can upload these documents into your personal Relevance AI account under the name <em>quickstart_clustering_kmeans</em></p>\n\n</div>\n<div class=\"magic-block-code\">\n\t<ul class=\"block-code-header\">\n\t\t<li><a href=\"\" ng-click=\"showCode(0)\" ng-class=\"{active: (0 == tab)}\">Python (SDK)</a></li>\n\t</ul>\n\t<div class=\"block-code-code\"><span ng-if=\"tab == 0\">\n\t\t\t<button ng-click=\"copyCode(93)\" class=\"copy-code-button\"><span ng-show=\"!copied\" class=\"fa fa-clipboard\"></span><span ng-show=\"copied\" class=\"fa fa-check\"></span></button>\n\t\t\t<textarea ng-non-bindable=\"ng-non-bindable\" style=\"position: absolute; left: -10000px;\" id=\"text-code-93\">ds = client.Dataset(&quot;quickstart_kmeans_clustering&quot;)\nds.insert_documents(documents)</textarea>\n\t\t\t<pre id=\"code-93\"><code><span class='cm-s-neo'><span class=\"cm-variable\">ds</span> <span class=\"cm-operator\">=</span> <span class=\"cm-variable\">client</span>.<span class=\"cm-property\">Dataset</span>(<span class=\"cm-string\">\"quickstart_kmeans_clustering\"</span>)\n<span class=\"cm-variable\">ds</span>.<span class=\"cm-property\">insert_documents</span>(<span class=\"cm-variable\">documents</span>)</span></code></pre></span>\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><p>Let&#39;s have a look at the schema to see what vector fields are available for clustering.</p>\n\n</div>\n<div class=\"magic-block-code\">\n\t<ul class=\"block-code-header\">\n\t\t<li><a href=\"\" ng-click=\"showCode(0)\" ng-class=\"{active: (0 == tab)}\">Python (SDK)</a></li>\n\t</ul>\n\t<div class=\"block-code-code\"><span ng-if=\"tab == 0\">\n\t\t\t<button ng-click=\"copyCode(280)\" class=\"copy-code-button\"><span ng-show=\"!copied\" class=\"fa fa-clipboard\"></span><span ng-show=\"copied\" class=\"fa fa-check\"></span></button>\n\t\t\t<textarea ng-non-bindable=\"ng-non-bindable\" style=\"position: absolute; left: -10000px;\" id=\"text-code-280\">ds.schema</textarea>\n\t\t\t<pre id=\"code-280\"><code><span class='cm-s-neo'><span class=\"cm-variable\">ds</span>.<span class=\"cm-property\">schema</span></span></code></pre></span>\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><p>The result is a JSON output similar to what is shown below. As can be seen, there are two vector fields in the dataset <code>product_image_clip_vector_</code> and <code>product_title_clip_vector_</code>.</p>\n\n</div>\n<div class=\"magic-block-code\">\n\t<ul class=\"block-code-header\">\n\t\t<li><a href=\"\" ng-click=\"showCode(0)\" ng-class=\"{active: (0 == tab)}\">JSON</a></li>\n\t</ul>\n\t<div class=\"block-code-code\"><span ng-if=\"tab == 0\">\n\t\t\t<button ng-click=\"copyCode(684)\" class=\"copy-code-button\"><span ng-show=\"!copied\" class=\"fa fa-clipboard\"></span><span ng-show=\"copied\" class=\"fa fa-check\"></span></button>\n\t\t\t<textarea ng-non-bindable=\"ng-non-bindable\" style=\"position: absolute; left: -10000px;\" id=\"text-code-684\">{\n 'insert_date_': 'date',\n 'product_image': 'text',\n 'product_image_clip_vector_': {'vector': 512},\n 'product_link': 'text',\n 'product_price': 'text',\n 'product_title': 'text',\n 'product_title_clip_vector_': {'vector': 512},\n 'query': 'text',\n 'source': 'text'\n}</textarea>\n\t\t\t<pre id=\"code-684\"><code><span class='cm-s-neo'>{\n <span class=\"cm-property\">'insert_date_'</span>: <span class=\"cm-string\">'date'</span>,\n <span class=\"cm-property\">'product_image'</span>: <span class=\"cm-string\">'text'</span>,\n <span class=\"cm-property\">'product_image_clip_vector_'</span>: {<span class=\"cm-property\">'vector'</span>: <span class=\"cm-number\">512</span>},\n <span class=\"cm-property\">'product_link'</span>: <span class=\"cm-string\">'text'</span>,\n <span class=\"cm-property\">'product_price'</span>: <span class=\"cm-string\">'text'</span>,\n <span class=\"cm-property\">'product_title'</span>: <span class=\"cm-string\">'text'</span>,\n <span class=\"cm-property\">'product_title_clip_vector_'</span>: {<span class=\"cm-property\">'vector'</span>: <span class=\"cm-number\">512</span>},\n <span class=\"cm-property\">'query'</span>: <span class=\"cm-string\">'text'</span>,\n <span class=\"cm-property\">'source'</span>: <span class=\"cm-string\">'text'</span>\n}</span></code></pre></span>\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><h3 class=\"header-scroll\"><div class=\"anchor waypoint\" id=\"section-2-run-kmeans-clustering-algorithm-in-one-go\"></div>2. Run Kmeans clustering algorithm in one go<a class=\"fa fa-anchor\" href=\"#section-2-run-kmeans-clustering-algorithm-in-one-go\"></a></h3>\n<p>The easiest way to run a Kmeans clustering algorithm under the Relevance AI platform is the <code>auto_cluster</code> function. The following code snippet shows how generate 10 clusters using the <code>product_title_clip_vector_</code> vector field.</p>\n\n</div>\n<div class=\"magic-block-code\">\n\t<ul class=\"block-code-header\">\n\t\t<li><a href=\"\" ng-click=\"showCode(0)\" ng-class=\"{active: (0 == tab)}\">Python (SDK)</a></li>\n\t</ul>\n\t<div class=\"block-code-code\"><span ng-if=\"tab == 0\">\n\t\t\t<button ng-click=\"copyCode(138)\" class=\"copy-code-button\"><span ng-show=\"!copied\" class=\"fa fa-clipboard\"></span><span ng-show=\"copied\" class=\"fa fa-check\"></span></button>\n\t\t\t<textarea ng-non-bindable=\"ng-non-bindable\" style=\"position: absolute; left: -10000px;\" id=\"text-code-138\">clusterer = ds.auto_cluster(ALIAS-10, [&quot;product_title_clip_vector_&quot;])</textarea>\n\t\t\t<pre id=\"code-138\"><code><span class='cm-s-neo'><span class=\"cm-variable\">clusterer</span> <span class=\"cm-operator\">=</span> <span class=\"cm-variable\">ds</span>.<span class=\"cm-property\">auto_cluster</span>(<span class=\"cm-variable\">ALIAS</span><span class=\"cm-operator\">-</span><span class=\"cm-number\">10</span>, [<span class=\"cm-string\">\"product_title_clip_vector_\"</span>])</span></code></pre></span>\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><p>Another way of clustering is to use the ClusterOps class as shown in the snippet below:</p>\n\n</div>\n<div class=\"magic-block-code\">\n\t<ul class=\"block-code-header\">\n\t\t<li><a href=\"\" ng-click=\"showCode(0)\" ng-class=\"{active: (0 == tab)}\">Python (SDK)</a></li>\n\t</ul>\n\t<div class=\"block-code-code\"><span ng-if=\"tab == 0\">\n\t\t\t<button ng-click=\"copyCode(181)\" class=\"copy-code-button\"><span ng-show=\"!copied\" class=\"fa fa-clipboard\"></span><span ng-show=\"copied\" class=\"fa fa-check\"></span></button>\n\t\t\t<textarea ng-non-bindable=\"ng-non-bindable\" style=\"position: absolute; left: -10000px;\" id=\"text-code-181\">from relevanceai.clusterer import KMeansModel\n\nVECTOR_FIELD = &quot;product_title_clip_vector_&quot;\nKMEAN_NUMBER_OF_CLUSTERS = 10\nALIAS = &quot;kmeans_&quot; + str(KMEAN_NUMBER_OF_CLUSTERS)\n\nmodel = KMeansModel(k=KMEAN_NUMBER_OF_CLUSTERS)\nclusterer = client.ClusterOps(alias=ALIAS, model=model)\nclusterer.fit_predict_update(df, [VECTOR_FIELD])</textarea>\n\t\t\t<pre id=\"code-181\"><code><span class='cm-s-neo'><span class=\"cm-keyword\">from</span> <span class=\"cm-variable\">relevanceai</span>.<span class=\"cm-property\">clusterer</span> <span class=\"cm-keyword\">import</span> <span class=\"cm-variable\">KMeansModel</span>\n\n<span class=\"cm-variable\">VECTOR_FIELD</span> <span class=\"cm-operator\">=</span> <span class=\"cm-string\">\"product_title_clip_vector_\"</span>\n<span class=\"cm-variable\">KMEAN_NUMBER_OF_CLUSTERS</span> <span class=\"cm-operator\">=</span> <span class=\"cm-number\">10</span>\n<span class=\"cm-variable\">ALIAS</span> <span class=\"cm-operator\">=</span> <span class=\"cm-string\">\"kmeans_\"</span> <span class=\"cm-operator\">+</span> <span class=\"cm-builtin\">str</span>(<span class=\"cm-variable\">KMEAN_NUMBER_OF_CLUSTERS</span>)\n\n<span class=\"cm-variable\">model</span> <span class=\"cm-operator\">=</span> <span class=\"cm-variable\">KMeansModel</span>(<span class=\"cm-variable\">k</span><span class=\"cm-operator\">=</span><span class=\"cm-variable\">KMEAN_NUMBER_OF_CLUSTERS</span>)\n<span class=\"cm-variable\">clusterer</span> <span class=\"cm-operator\">=</span> <span class=\"cm-variable\">client</span>.<span class=\"cm-property\">ClusterOps</span>(<span class=\"cm-variable\">alias</span><span class=\"cm-operator\">=</span><span class=\"cm-variable\">ALIAS</span>, <span class=\"cm-variable\">model</span><span class=\"cm-operator\">=</span><span class=\"cm-variable\">model</span>)\n<span class=\"cm-variable\">clusterer</span>.<span class=\"cm-property\">fit_predict_update</span>(<span class=\"cm-variable\">df</span>, [<span class=\"cm-variable\">VECTOR_FIELD</span>])</span></code></pre></span>\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><p>The <code>fit_predict_update()</code> function performs the following steps:</p>\n<ol>\n<li  value=\"1\">loading the data</li><li  value=\"2\">clustering</li><li  value=\"3\">writing the results back to the dataset</li></ol>\n<p>By loading the data from the dataset after clustering is done, you can see to which cluster each data point belongs. Here, we see how the first 5 data points are clustered:</p>\n\n</div>\n<div class=\"magic-block-code\">\n\t<ul class=\"block-code-header\">\n\t\t<li><a href=\"\" ng-click=\"showCode(0)\" ng-class=\"{active: (0 == tab)}\">Python (SDK)</a></li>\n\t</ul>\n\t<div class=\"block-code-code\"><span ng-if=\"tab == 0\">\n\t\t\t<button ng-click=\"copyCode(866)\" class=\"copy-code-button\"><span ng-show=\"!copied\" class=\"fa fa-clipboard\"></span><span ng-show=\"copied\" class=\"fa fa-check\"></span></button>\n\t\t\t<textarea ng-non-bindable=\"ng-non-bindable\" style=\"position: absolute; left: -10000px;\" id=\"text-code-866\">from relevanceai import show_json\n\nsample_documents = ds.sample(n=5)\nsamples = [{\n    'product_title':d['product_title'],\n    'cluster':d['_cluster_'][VECTOR_FIELD][ALIAS]\n} for d in sample_documents]\n\nshow_json(samples, text_fields=['product_title', 'cluster'])</textarea>\n\t\t\t<pre id=\"code-866\"><code><span class='cm-s-neo'><span class=\"cm-keyword\">from</span> <span class=\"cm-variable\">relevanceai</span> <span class=\"cm-keyword\">import</span> <span class=\"cm-variable\">show_json</span>\n\n<span class=\"cm-variable\">sample_documents</span> <span class=\"cm-operator\">=</span> <span class=\"cm-variable\">ds</span>.<span class=\"cm-property\">sample</span>(<span class=\"cm-variable\">n</span><span class=\"cm-operator\">=</span><span class=\"cm-number\">5</span>)\n<span class=\"cm-variable\">samples</span> <span class=\"cm-operator\">=</span> [{\n    <span class=\"cm-string\">'product_title'</span>:<span class=\"cm-variable\">d</span>[<span class=\"cm-string\">'product_title'</span>],\n    <span class=\"cm-string\">'cluster'</span>:<span class=\"cm-variable\">d</span>[<span class=\"cm-string\">'_cluster_'</span>][<span class=\"cm-variable\">VECTOR_FIELD</span>][<span class=\"cm-variable\">ALIAS</span>]\n} <span class=\"cm-keyword\">for</span> <span class=\"cm-variable\">d</span> <span class=\"cm-keyword\">in</span> <span class=\"cm-variable\">sample_documents</span>]\n\n<span class=\"cm-variable\">show_json</span>(<span class=\"cm-variable\">samples</span>, <span class=\"cm-variable\">text_fields</span><span class=\"cm-operator\">=</span>[<span class=\"cm-string\">'product_title'</span>, <span class=\"cm-string\">'cluster'</span>])</span></code></pre></span>\n\t</div>\n</div>\n<div class=\"magic-block-textarea\"><p>&lt;figure&gt;<br><img src=\"https://github.com/RelevanceAI/RelevanceAI-readme-docs/blob/v2.0.0/docs_template/clustering-features/_assets/RelevanceAI_clustering_quickstart_kmeans_results.png?raw=true\"  width=\"450\" alt=\"Clustering results\"></p>\n<p>&lt;figcaption&gt;&lt;/figcaption&gt;</p>\n<p>&lt;figure&gt;\n\n</p>\n<p>If you are interested to know more details about what happens behind the scene, visit our next page on step-by-step clustering.</p>\n\n</div>"
}