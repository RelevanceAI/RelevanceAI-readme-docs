---
title: "Text search (using USE VectorHub)"
excerpt: ""
slug: "quickstart-text-search"
hidden: false

---

<figure>
<img src="https://github.com/RelevanceAI/RelevanceAI-readme-docs/blob/v2.0.0-autoresolve-git-conflict/docs_template/getting-started/example-applications/_assets/RelevanceAI_text_search.png?raw=true"
     alt="RelevanceAI Text to Image"
     style="width: 100% vertical-align: middle"/>
<figcaption>
<a href="https://tfhub.dev/google/universal-sentence-encoder/4">Universal Sentence Encoder encoding process</a>
</figcaption>

<figure>

In this section, we will show you how to create and experiment with a powerful text search engine using Google's Universal Sentence Encoder through [VectorHub library](https://github.com/RelevanceAI/vectorhub) and Relevance AI.

**Try it out in Colab:** [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/RelevanceAI/RelevanceAI-readme-docs/blob/v2.0.0-autoresolve-git-conflict/docs/getting-started/example-applications/_notebooks/RelevanceAI-ReadMe-Text-Search-using-USE-VectorHub.ipynb)


### What I Need
* Project and API Key: Grab your RelevanceAI project and API key by [signing up](https://cloud.relevance.ai/ )
* Python 3 (ideally a Jupyter Notebook/Colab environment)

### Installation Requirements


[block:code]
{
  "codes": [
    {
      "code": "# remove `!` if running the line in a terminal\n!pip install -U RelevanceAI-dev[notebook]>=2.0.0",
      "name": "Bash",
      "language": "shell"
    }
  ]
}
[/block]


### Setting Up Client

To be able to use Relevance AI, you need to instantiate a client. This needs a Project and API key that can be accessed at [https://cloud.relevance.ai/](https://cloud.relevance.ai/) in the settings area! Alternatively, you can run the code below and follow the link and the guide.


[block:code]
{
  "codes": [
    {
      "code": "from relevanceai import Client\n\n\"\"\"\nYou can sign up/login and find your credentials here: https://cloud.relevance.ai/sdk/api\nOnce you have signed up, click on the value under `Activation token` and paste it here\n\"\"\"\nclient = Client()",
      "name": "Python (SDK)",
      "language": "python"
    }
  ]
}
[/block]

## Text Search with Universal Sentence Encoder using VectorHub
### 1. Data

For this experiment, we use our sample e-commerce dataset and preview one of the documents.

[block:code]
{
  "codes": [
    {
      "code": "import pandas as pd\nfrom relevanceai.utils.datasets import get_ecommerce_dataset_clean\n\n# Retrieve our sample dataset. - This comes in the form of a list of documents.\ndocuments = get_ecommerce_dataset_clean()\n\npd.DataFrame.from_dict(documents).head()",
      "name": "Python (SDK)",
      "language": "python"
    }
  ]
}
[/block]

An example document should have a structure that looks like this.

[block:code]
{
  "codes": [
    {
      "code": "{'_id': '711160239',\n  'product_image': 'https://thumbs4.ebaystatic.com/d/l225/pict/321567405391_1.jpg',\n  'product_link': 'https://www.ebay.com/itm/20-36-Mens-Silver-Stainless-Steel-Braided-Wheat-Chain-Necklace-Jewelry-3-4-5-6MM-/321567405391?pt=LH_DefaultDomain_0&var=&hash=item4adee9354f',\n  'product_price': '$7.99 to $12.99',\n  'product_title': '20-36Mens Silver Stainless Steel Braided Wheat Chain Necklace Jewelry 3/4/5/6MM\"',\n  'query': 'steel necklace',\n  'source': 'eBay'\n}",
      "name": "JSON",
      "language": "json"
    }
  ]
}
[/block]

### 2. Encode

Next, we will instantiate the universal sentence encoder from VectorHub and encode the `product_title` field among all documents.

[block:code]
{
  "codes": [
    {
      "code": "from vectorhub.encoders.text.tfhub import USE2Vec\nmodel = USE2Vec()\n\ndocuments = model.encode_documents(fields=['product_title'], documents=documents)",
      "name": "Python (SDK)",
      "language": "python"
    }
  ]
}
[/block]

We can see that there is now a field called `product_title_use_vector_` in our data.
`_use_vector_` is the name assigned to the model in Vectorhub and we use it when generating vectors.
If you prefer a different name, simply modify the `__name__` attribute via


```python Python (SDK)

enc.__name__ = "model_name_goes_here"
```
```python
```

### 3. Insert

The data can be easily uploaded to Relevance AI platform via `insert_documents`.


[block:code]
{
  "codes": [
    {
      "code": "ds = client.Dataset(\"quickstart_text_searc\")\nds.insert_documents(documents)",
      "name": "Python (SDK)",
      "language": "python"
    }
  ]
}
[/block]

### 3. Search

Note that our dataset includes vectors generated by Universal Sentence Encoder. Therefore, in this step, we first vectorize the query using the same encoder to be able to search among the similarly generated vectors.


[block:code]
{
  "codes": [
    {
      "code": "query = 'Gift for my son'\nquery_vector = model.encode(query)",
      "name": "Python (SDK)",
      "language": "python"
    }
  ]
}
[/block]


Simple vector search against our dataset:

[block:code]
{
  "codes": [
    {
      "code": "multivector_query=[\n    { \"vector\": query_vector, \"fields\": [\"product_title_use_vector_\"]}\n]\nresults = ds.vector_search(\n    multivector_query=multivector_query,\n    page_size=5\n)",
      "name": "Python (SDK)",
      "language": "python"
    }
  ]
}
[/block]


We can see the results on the dashboard via the provided link after the search finishes. Or using Relevance AI `json_shower` as shown below:

[block:code]
{
  "codes": [
    {
      "code": "from relevanceai import show_json\n\nprint('=== QUERY === ')\nprint(query)\n\nprint('=== RESULTS ===')\nshow_json(results, image_fields=[\"product_image\"], text_fields=[\"product_title\"])",
      "name": "Python (SDK)",
      "language": "python"
    }
  ]
}
[/block]



<figure>
<img src="https://github.com/RelevanceAI/RelevanceAI-readme-docs/blob/v2.0.0-autoresolve-git-conflict/docs_template/getting-started/example-applications/_assets/RelevanceAI_text_search_results.png?raw=true"
     alt="Text Search Results"
     style="width: 100% vertical-align: middle"/>
<figcaption>Text Search Results</figcaption>

<figure>

This is just a quick and basic example of using Relevance AI for text search, there are many other search features such as faceted vector search, hybrid search, chunk search, multivector search. For further information please visit [Better text search](doc:better-text-search).


[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/RelevanceAI/RelevanceAI-readme-docs/blob/v2.0.0-autoresolve-git-conflict/docs/getting-started/example-applications/_notebooks/RelevanceAI-ReadMe-Text-Search-using-USE-VectorHub.ipynb)



## Final Code

[block:code]
{
  "codes": [
    {
      "code": "from relevanceai import Client\n\n\"\"\"\nYou can sign up/login and find your credentials here: https://cloud.relevance.ai/sdk/api\nOnce you have signed up, click on the value under `Activation token` and paste it here\n\"\"\"\nclient = Client()\nimport pandas as pd\nfrom relevanceai.utils.datasets import get_ecommerce_dataset_clean\n\n# Retrieve our sample dataset. - This comes in the form of a list of documents.\ndocuments = get_ecommerce_dataset_clean()\n\npd.DataFrame.from_dict(documents).head()\nfrom vectorhub.encoders.text.tfhub import USE2Vec\nmodel = USE2Vec()\n\ndocuments = model.encode_documents(fields=['product_title'], documents=documents)\nds = client.Dataset(\"quickstart_text_searc\")\nds.insert_documents(documents)\nquery = 'Gift for my son'\nquery_vector = model.encode(query)\nmultivector_query=[\n    { \"vector\": query_vector, \"fields\": [\"product_title_use_vector_\"]}\n]\nresults = ds.vector_search(\n    multivector_query=multivector_query,\n    page_size=5\n)\nfrom relevanceai import show_json\n\nprint('=== QUERY === ')\nprint('Gift for my son')\n\nprint('=== RESULTS ===')\nshow_json(results, image_fields=[\"product_image\"], text_fields=[\"product_title\"])",
      "name": "Python (SDK)",
      "language": "python"
    }
  ]
}
[/block]

